import{_ as H,a as L}from"./Loading.vue.501f43fd.js";import{j as T,y as V,q as c,o as s,c as a,t as k,g as o,z as _,b as i,w as g,d as x,h as F,a as b,F as z,n as $,s as P,r as C,k as U,f as j,B as D,C as E,m as I,D as N,i as M}from"./entry.c4fe7854.js";import{a as W}from"./str.08505d9c.js";import{_ as A}from"./_plugin-vue_export-helper.c27b6911.js";import{u as O}from"./rdf.7f77f2a6.js";import{c as B}from"./config.b87703fb.js";import"./axios.7bde71be.js";const Q={style:{position:"relative"}},G={key:0,class:"text-h3 mb-5 mt-2"},J={style:{"white-space":"nowrap"}},K=["href","title"],X={key:1},Y=["onClick"],Z=["title"],ee=T({__name:"Search",props:{list:{},headerTitle:{},excludeFields:{},fields:{},info:{type:Boolean},links:{}},setup(R){const n=R,d=n.excludeFields?n.excludeFields:[/^prez:./],m=(n.fields?n.fields:Object.keys(n.list.listHeaders)).filter(e=>{for(const h in d)if(e.match(d[h]))return!!(n.fields&&n.fields.indexOf(e)>=0);return!0});return V(),(e,h)=>{const p=c("v-chip"),f=c("v-icon"),v=c("v-btn"),u=c("v-table"),y=H;return s(),a("div",Q,[e.headerTitle&&e.list?(s(),a("div",G,k(o(W)(e.headerTitle,e.list)),1)):_("",!0),i(p,{variant:"flat",style:{position:"absolute",right:"0",top:"0"}},{default:g(()=>[x(k(e.list.header.label),1)]),_:1}),e.list?(s(),F(u,{key:1,theme:"dark"},{default:g(()=>[b("thead",null,[b("tr",null,[(s(!0),a(z,null,$(o(m),t=>(s(),a("th",J,[x(k(t in e.list.listHeaders?e.list.listHeaders[t].label:`${t} missing`)+" Â ",1),t in e.list.listHeaders?(s(),a("a",{key:0,href:e.list.listHeaders[t].iri,title:t},[i(f,{icon:"mdi-link"})],8,K)):_("",!0),e.info?(s(),a("div",X,k(t),1)):_("",!0)]))),256))])]),b("tbody",null,[(s(!0),a(z,null,$(e.list.list,t=>(s(),a("tr",{onClick:r=>typeof t["prez:link"]=="string"?e.$router.push(t["prez:link"]):null},[(s(!0),a(z,null,$(o(m),r=>(s(),a("td",null,[b("div",{title:r in t?t[r]:null,class:"td-max"},[r=="prez:link"?(s(!0),a(z,{key:0},$(typeof t[r]=="object"?t[r]:[t[r]],l=>(s(),F(v,{class:"mr-4",to:l},{default:g(()=>[x(k(l),1)]),_:2},1032,["to"]))),256)):_("",!0),x(" "+k(r!="prez:link"?r in t?t[r]:`"${r}" not found`:""),1)],8,Z)]))),256))],8,Y))),256))])]),_:1})):_("",!0),i(y,{links:e.links},null,8,["links"])])}}});const te=A(ee,[["__scopeId","data-v-c3551b39"]]),se=T({__name:"Search",props:{dataUrl:{},headerTitle:{},excludeFields:{},fields:{},info:{type:Boolean}},setup(R){const n=R,d=O(),{loading:m,success:e,error:h,prez:p}=P(d),f=C(null),v=C(1),u=C(void 0);U(async()=>{await r()});const y=j(),t=C(y.query);D(()=>t.value=y.query,()=>{});async function r(){if(await d.load(n.dataUrl,{params:{page:v.value}}),e.value)try{f.value=null,u.value=p.value.search(["skos:prefLabel","rdfs:label"]),u.value.list.sort((l,S)=>{const w=parseInt(l["prez:searchResultWeight"]),q=parseInt(S["prez:searchResultWeight"]);return w>q?1:w<q?-1:0})}catch(l){f.value=l.message}}return(l,S)=>{const w=te,q=L;return s(),a(z,null,[o(u)?(s(),F(w,{key:0,"header-title":l.headerTitle,list:o(u),fields:l.fields,"exclude-fields":l.excludeFields,info:l.info,links:o(p).headerLinks},null,8,["header-title","list","fields","exclude-fields","info","links"])):_("",!0),i(q,{loading:o(m),error:o(h)},null,8,["loading","error"]),i(q,{loading:!1,error:o(f)},null,8,["error"])],64)}}}),ne={class:"justify-center"},oe=b("h1",{class:"mb-5"},"Text search",-1),re=["onSubmit"],_e=T({__name:"search",setup(R){const n=j(),d=V(),m=M(),e=C(n.query.q);function h(){d.push({path:"/search",query:{...n.query,q:e.value}})}const p=E(()=>"q"in n.query&&n.query.q!==""?n.fullPath:null);return(f,v)=>{const u=c("v-text-field"),y=c("v-btn"),t=c("v-card-text"),r=c("v-card"),l=se;return s(),a("div",ne,[i(r,{class:"mx-auto","max-width":"800",flat:""},{default:g(()=>[i(t,null,{default:g(()=>[oe,b("form",{class:"d-flex justify-end mt-5",method:"get",onSubmit:N(h,["stop","prevent"])},[i(u,{density:"compact",variant:"solo",label:"Enter text to lookup","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",autofocus:!0,name:"q",modelValue:o(e),"onUpdate:modelValue":v[0]||(v[0]=S=>I(e)?e.value=S:null)},null,8,["modelValue"]),i(y,{type:"submit",color:"primary",class:"ml-5 pl-4 pr-4",size:"medium"},{default:g(()=>[x("Search")]),_:1})],40,re)]),_:1})]),_:1}),o(p)?(s(),F(l,{key:o(p),"header-title":"{{ count }} Result(s)","data-url":o(B).getUrl(o(B).API_BASE_URL+o(n).fullPath,o(m)),fields:["prez:searchResultMatch","prez:searchResultPredicate","prez:searchResultWeight","prez:link"]},null,8,["header-title","data-url"])):_("",!0)])}}});export{_e as default};
